"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const config_1 = require("hardhat/config");
const task_names_1 = require("../task-names");
// purpose: for testing the extraction of artifact compilation data for use in hardhat-cannon
(0, config_1.subtask)(task_names_1.SUBTASK_GET_ARTIFACT).setAction(async ({ name }, hre) => {
    const art = (await hre.artifacts.readArtifact(name));
    if (art) {
        const dependencyGraph = await hre.run('compile:solidity:get-dependency-graph', { sourceNames: [art.sourceName] });
        const resolvedFile = dependencyGraph.getResolvedFiles()[0];
        const compileJob = await hre.run('compile:solidity:get-compilation-job-for-file', {
            file: resolvedFile,
            dependencyGraph,
        });
        const solidityInput = await hre.run('compile:solidity:get-compiler-input', { compilationJob: compileJob });
        const buildInfo = await hre.artifacts.getBuildInfo(`${art.sourceName}:${art.contractName}`);
        art.source = {
            solcVersion: buildInfo.solcLongVersion,
            input: JSON.stringify(solidityInput),
        };
    }
    return art;
});
//# sourceMappingURL=get-artifact-data.js.map