"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createError = exports.ValidationError = void 0;
const render_1 = require("./render");
class ValidationError extends Error {
}
exports.ValidationError = ValidationError;
/**
 * Create a ValidationError with a custom stack trace generated based on the
 * given AST nodes, and print the solidity path stack trace.
 */
function createError({ message, sourceUnit, nodes = [], }) {
    const err = new ValidationError(message);
    const [title] = err.stack.split('\n');
    const stack = [];
    try {
        const { absolutePath } = sourceUnit;
        for (const node of nodes) {
            const title = _getErrorTitle(node);
            if (!title)
                continue;
            stack.unshift(`    at ${title} (${absolutePath})`);
        }
    }
    catch (err) {
        console.warn('Could not render stack trace.');
    }
    stack.unshift(title);
    err.stack = stack.join('\n');
    return err;
}
exports.createError = createError;
function _getErrorTitle(node) {
    /* eslint-disable */
    switch (node.nodeType) {
        case 'ContractDefinition':
            return `${node.contractKind} ${node.name}`;
        case 'VariableDeclaration':
            return (0, render_1.render)(node);
        // eslint-disable-next-line @typescript-eslint/no-explicit-any
        default:
            return node.name;
    }
}
//# sourceMappingURL=error.js.map